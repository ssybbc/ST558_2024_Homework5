[
  {
    "objectID": "HW5.html",
    "href": "HW5.html",
    "title": "ST550-homework5",
    "section": "",
    "text": "This week we are going to work on a student data, basically using exploratory data analysis to analyze the distribution of students’ score and analyze the relationship between students’ score and their home life. The data we are going to use are from the UCI machine learning data repository and is about secondary education in two Portugease schools. I actually searched online for the school name “Gabriel Pereira” and found it is actually in the southern area of Portugal, a city called Evora. This city comes with nice districting, neat road design, with residential and commerical in the center and northern part of the city and large factory in the south and eastern outskirts, and is facilitated by a express ring road. Another school named “Mousinho da Silveira” is seated in the mountain area that boarders Spain. The spread of city itself is linear from north to south and there is even a Castle in the city."
  },
  {
    "objectID": "HW5.html#categorical-variables",
    "href": "HW5.html#categorical-variables",
    "title": "ST550-homework5",
    "section": "Categorical variables",
    "text": "Categorical variables\nBaseR has a good function to generate contigency table called table(). We will first use this function to generate a one-way, a two-way and a three-way contingency table.\n\ntable(matpor4$schoolfct)\n\n\n GP  MS \n287  33 \n\n\nThis one-way contingency table showed basically the number of students from each school in the combined data set. For example, there are 287 students in the GP high school.\n\ntable (matpor4$Mjobfct, matpor4$studytimefct)\n\n          \n            1  2  3  4\n  at_home  10 21 11  2\n  health    8 16  4  2\n  other    29 58 17 12\n  services 21 33 14  7\n  teacher  13 29 10  3\n\n\nThis two-way contingency table showed the students’ weekly study time and their mom’s job. For example, it showed there are 7 students whose moms work as civic servants had weekly study time more than 10 hours.\n\ntable (matpor4$Mjobfct, matpor4$studytimefct, matpor4$Fjobfct)\n\n, ,  = at_home\n\n          \n            1  2  3  4\n  at_home   1  2  3  0\n  health    0  0  0  0\n  other     0  2  2  0\n  services  0  1  1  0\n  teacher   1  1  0  0\n\n, ,  = health\n\n          \n            1  2  3  4\n  at_home   0  1  0  0\n  health    1  2  1  1\n  other     0  1  0  1\n  services  0  0  2  1\n  teacher   0  3  1  0\n\n, ,  = other\n\n          \n            1  2  3  4\n  at_home   7 10  4  2\n  health    5  9  1  0\n  other    21 44 13  9\n  services  8 16  5  2\n  teacher   4 14  2  1\n\n, ,  = services\n\n          \n            1  2  3  4\n  at_home   2  6  4  0\n  health    2  4  2  1\n  other     6  8  1  2\n  services 11 14  4  4\n  teacher   3  5  6  2\n\n, ,  = teacher\n\n          \n            1  2  3  4\n  at_home   0  2  0  0\n  health    0  1  0  0\n  other     2  3  1  0\n  services  2  2  2  0\n  teacher   5  6  1  0\n\n\nIn addition, this three-way contingency table showed the weekly study time and their mom’s job, on the condition of their father’s job. You could see there are 4 students whose both parents work as civic servants study more than 10 hours a week.\nNext we will create a conditional two-way table using filter () function and subsetting separately.\n\nmatpor4subset &lt;- matpor4|&gt; filter (Fjobfct == \"health\")\ntable (matpor4subset$Mjobfct, matpor4subset$studytimefct)\n\n          \n           1 2 3 4\n  at_home  0 1 0 0\n  health   1 2 1 1\n  other    0 1 0 1\n  services 0 0 2 1\n  teacher  0 3 1 0\n\n\nAbove is the filter data method\n\njbsttmtable &lt;- table (matpor4$Mjobfct, matpor4$studytimefct, matpor4$Fjobfct)\njbsttmtable[,,2]\n\n          \n           1 2 3 4\n  at_home  0 1 0 0\n  health   1 2 1 1\n  other    0 1 0 1\n  services 0 0 2 1\n  teacher  0 3 1 0\n\n\nThe above is the subsetting method.\nNext we create a two-way contingency table using group_by() and summarize(). For example we could do school and study time.\n\nmatpor4 |&gt; group_by(schoolfct, studytimefct) |&gt; summarize (count = n())\n\n`summarise()` has grouped output by 'schoolfct'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 7 × 3\n# Groups:   schoolfct [2]\n  schoolfct studytimefct count\n  &lt;fct&gt;     &lt;fct&gt;        &lt;int&gt;\n1 GP        1               69\n2 GP        2              143\n3 GP        3               49\n4 GP        4               26\n5 MS        1               12\n6 MS        2               14\n7 MS        3                7\n\n\nWe could use the function pivot_wider() to transform the table into a table()-style like output.\n\nmatpor4 |&gt; group_by(schoolfct, studytimefct) |&gt; summarize (count = n()) |&gt; pivot_wider(names_from = schoolfct, values_from = count)\n\n`summarise()` has grouped output by 'schoolfct'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 4 × 3\n  studytimefct    GP    MS\n  &lt;fct&gt;        &lt;int&gt; &lt;int&gt;\n1 1               69    12\n2 2              143    14\n3 3               49     7\n4 4               26    NA\n\n\nLastly we will create a bar graph showed the number of students with different mothers’ job.\n\nggplot (data = matpor4, aes (x = Mjobfct)) +\n  geom_bar() +\n  labs (x=\"Mother's job\")\n\n\n\n\n\n\n\n\nWe then create a side-by-side bar graph showing the number of students with different study time and mother’s job.\n\nggplot (data = matpor4, aes (x = studytimefct, fill = Mjobfct)) +\n  geom_bar(position = \"dodge\") +\n  labs (x=\"Weekly study time level\")"
  },
  {
    "objectID": "HW5.html#numeric-variables",
    "href": "HW5.html#numeric-variables",
    "title": "ST550-homework5",
    "section": "Numeric variables",
    "text": "Numeric variables\nFirst we want to find the center and spread to characterize the numeric variable in the combined data set: age, absence and G3. Need to remember for the combined data set, there are two variable for G3, one for math, another one for Portuguese.\n\nnumericsummary &lt;- matpor4 |&gt; \n  rename (absences_mat = absences.x, absences.por = absences.y, G3_mat = G3.x, G3_por = G3.y) |&gt; \n  summarize (across (c(age, absences_mat, G3_mat),                                                                       .fns = list (\"mean\" = mean, \"median\" = median, \"var\" = var, \"sd\" = sd, \"IQR\" = IQR), \n                     .names = \"{.fn}_{.col}\"))\n\nWe could subset the data only to show the stats related with the variable “age”, “absences_mat”, “G3_mat”\n\nnumericsummary [1:5]\n\n# A tibble: 1 × 5\n  mean_age median_age var_age sd_age IQR_age\n     &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;\n1     16.5         16    1.30   1.14       1\n\nnumericsummary [6:10]\n\n# A tibble: 1 × 5\n  mean_absences_mat median_absences_mat var_absences_mat sd_absences_mat\n              &lt;dbl&gt;               &lt;dbl&gt;            &lt;dbl&gt;           &lt;dbl&gt;\n1              5.41                   4             61.4            7.84\n# ℹ 1 more variable: IQR_absences_mat &lt;dbl&gt;\n\nnumericsummary [11:15]\n\n# A tibble: 1 × 5\n  mean_G3_mat median_G3_mat var_G3_mat sd_G3_mat IQR_G3_mat\n        &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;\n1        11.0            11       18.5      4.30          5\n\n\nIt is better if we summarize the statistics of numeric variables according to different groups of sample students. We could grouping the numeric variables according to their Father’s job.\n\nnumericsummarygroup &lt;- matpor4 |&gt;\n  rename (absences_mat = absences.x, absences.por = absences.y, G3_mat = G3.x, G3_por = G3.y) |&gt; \n  group_by(Fjobfct) |&gt;\n  drop_na (Fjobfct) |&gt;\n  summarize (across (c(age, absences_mat, G3_mat), .fns = list (\"mean\" = mean, \"median\" = median), names = \"{.fn}_{.col}\"))\n\nWarning: There was 1 warning in `summarize()`.\nℹ In argument: `across(...)`.\nℹ In group 1: `Fjobfct = at_home`.\nCaused by warning:\n! The `...` argument of `across()` is deprecated as of dplyr 1.1.0.\nSupply arguments directly to `.fns` through an anonymous function instead.\n\n  # Previously\n  across(a:b, mean, na.rm = TRUE)\n\n  # Now\n  across(a:b, \\(x) mean(x, na.rm = TRUE))\n\nnumericsummarygroup\n\n# A tibble: 5 × 7\n  Fjobfct  age_mean age_median absences_mat_mean absences_mat_median G3_mat_mean\n  &lt;fct&gt;       &lt;dbl&gt;      &lt;dbl&gt;             &lt;dbl&gt;               &lt;dbl&gt;       &lt;dbl&gt;\n1 at_home      16.6         17              4                      2        11.1\n2 health       15.8         16              4.47                   2        11.9\n3 other        16.6         17              5.59                   4        10.7\n4 services     16.6         17              5.48                   2        11.2\n5 teacher      16.5         16              5.30                   4        12.6\n# ℹ 1 more variable: G3_mat_median &lt;dbl&gt;\n\n\nFrom the table we could tell students whose fathers are teachers have a higher mean value for math score, and at home dads tend to have kids with less absence for math class. Now we would like to add another grouping factor: school.\n\nnumericsummarygroup &lt;- matpor4 |&gt;\n  rename (absences_mat = absences.x, absences.por = absences.y, G3_mat = G3.x, G3_por = G3.y) |&gt; \n  group_by(Fjobfct, schoolfct) |&gt;\n  drop_na (Fjobfct, schoolfct) |&gt;\n  summarize (across (c(age, absences_mat, G3_mat), .fns = list (\"mean\" = mean, \"median\" = median), names = \"{.fn}_{.col}\"))\n\n`summarise()` has grouped output by 'Fjobfct'. You can override using the\n`.groups` argument.\n\nnumericsummarygroup\n\n# A tibble: 9 × 8\n# Groups:   Fjobfct [5]\n  Fjobfct  schoolfct age_mean age_median absences_mat_mean absences_mat_median\n  &lt;fct&gt;    &lt;fct&gt;        &lt;dbl&gt;      &lt;dbl&gt;             &lt;dbl&gt;               &lt;dbl&gt;\n1 at_home  GP            16.5         16              3.73                   2\n2 at_home  MS            17.3         17              5                      7\n3 health   GP            15.8         16              4.47                   2\n4 other    GP            16.5         16              5.64                   4\n5 other    MS            17.9         18              4.92                   2\n6 services GP            16.3         16              6.35                   2\n7 services MS            17.7         18              1.33                   0\n8 teacher  GP            16.4         16              5.16                   4\n9 teacher  MS            18           18              7                      7\n# ℹ 2 more variables: G3_mat_mean &lt;dbl&gt;, G3_mat_median &lt;dbl&gt;\n\n\nIn general students tend to have lower math score and higher absences at MS high compared with GP high for math. However, if the students have teacher fathers then there is minimal differences in their average math score, although median math score is lower at MS high. Now that we could create a correlation matrix for all the numeric variables, including age, absences, G1/G2/G3 for math and Portuguese.\n\nmatpor4rename &lt;- matpor4 |&gt;\n  rename (absences_mat = absences.x, absences_por = absences.y, \n          G3_mat = G3.x, G3_por = G3.y, G1_mat = G1.x, G1_por = G1.y, G2_mat = G2.x, G2_por = G2.y)\nmatpor4rename |&gt; select (age, absences_mat, absences_por, G1_mat, G1_por, G2_mat, G2_por, G3_mat, G3_por) |&gt;\n  cor (method = \"pearson\") |&gt; round (2)\n\n               age absences_mat absences_por G1_mat G1_por G2_mat G2_por G3_mat\nage           1.00         0.14         0.05  -0.11  -0.05  -0.19   0.03  -0.21\nabsences_mat  0.14         1.00         0.56  -0.07  -0.09  -0.08  -0.15  -0.03\nabsences_por  0.05         0.56         1.00  -0.09  -0.10  -0.13  -0.12  -0.12\nG1_mat       -0.11        -0.07        -0.09   1.00   0.59   0.87   0.60   0.82\nG1_por       -0.05        -0.09        -0.10   0.59   1.00   0.54   0.88   0.52\nG2_mat       -0.19        -0.08        -0.13   0.87   0.54   1.00   0.57   0.91\nG2_por        0.03        -0.15        -0.12   0.60   0.88   0.57   1.00   0.55\nG3_mat       -0.21        -0.03        -0.12   0.82   0.52   0.91   0.55   1.00\nG3_por       -0.01        -0.14        -0.07   0.54   0.83   0.50   0.89   0.48\n             G3_por\nage           -0.01\nabsences_mat  -0.14\nabsences_por  -0.07\nG1_mat         0.54\nG1_por         0.83\nG2_mat         0.50\nG2_por         0.89\nG3_mat         0.48\nG3_por         1.00\n\n\nIn the correlation coefficient table, we could see the absences between the two classes are highly correlated, and absences are generally negatively correlated with scores. Regarding testing score, they are very highly correlated, even in different subjects. Probably the students who had higher score in one subject tend to not have a lower score in another subject as well. It would be interested to see how other variables contribute to the score of the two subjects as well. Next we will illustrate how different values of categorical variables affect the distribution of numeric variables. Specifically in this data set, we will be looking at how weekly study time affect the distribution of final score and math and Portuguese, using kernel density plot, histogram and box plot.\nFirst let’s plot a kernel density plot and a histogram\n\nggplot (matpor4rename, aes (x = G3_mat, fill = studytimefct)) +\n  geom_density (alpha = 0.5) +\n  xlab (\"Final score for math\")\n\n\n\n\n\n\n\n\n\nggplot (matpor4rename, aes (x = G3_mat, fill = studytimefct)) +\n geom_histogram (alpha = 0.5, position = \"identity\", bins = 15)+\n  xlab (\"Final score for math\")\n\n\n\n\n\n\n\n\nBecause there are very different number of students in each group of study time, so clearly density plot is a better choice. The data suggested the majority of students studying 2-5 hours weekly had a slightly lower score at Math. Here we plot the blox plot.\n\nggplot (matpor4rename, (aes (x = studytimefct, y = G3_mat, fill = studytimefct))) +\n  geom_boxplot() +\n  geom_jitter(width = 0.1, alpha = 0.6) +\n  xlab (\"Time spent on study\") +\n  ylab (\"Final score for math\")\n\n\n\n\n\n\n\n\nFollowing the same method, we could make plots for the Portuguese score.\n\nggplot (matpor4rename, aes (x = G3_por, fill = studytimefct)) +\n  geom_density (alpha = 0.5) +\n  xlab (\"Final score for Portuguese\")\n\n\n\n\n\n\n\n\n\nggplot (matpor4rename, aes (x = G3_por, fill = studytimefct)) +\n geom_histogram (alpha = 0.5, position = \"identity\", bins = 15)+\n  xlab (\"Final score for Portuguese\")\n\n\n\n\n\n\n\n\n\nggplot (matpor4rename, (aes (x = studytimefct, y = G3_por, fill = studytimefct))) +\n  geom_boxplot() +\n  geom_jitter(width = 0.1, alpha = 0.6) +\n  xlab (\"Time spent on study\") +\n  ylab (\"Final score for Portuguese\")\n\n\n\n\n\n\n\n\nIt is clearly from the kernel density plot and the box plot that students who study 5-10 hours weekly had the highest score for Portuguese, although there seemed to be a single person who study more than 10 hours a week scored really high on Portuguese.\nWe further explore the relationship between the 1st period grade and the final grade on math, with different levels of study time per week.\n\ng &lt;- ggplot (matpor4rename, aes (x = G1_mat, y = G3_mat, color = studytimefct)) +\n  geom_point(size = 3) +\n  geom_jitter(width = 0.1, alpha = 0.6, size = 3) +\n  xlab (\"Math first period grade\") +\n  ylab (\"Math final grade\")\n\nThere are a bunch of students who got zero for the final grade. Probably that is due to no show up. When exploring relations, better remove those points. In addition, there seemed to be strong relationship in each group of study time. We could add a trend line on this.\n\nmatpor4rename1 &lt;- matpor4rename |&gt; filter (G3_mat &gt; 0)\ng1 &lt;- matpor4rename1 |&gt; ggplot (aes (x = G1_mat, y = G3_mat, color = studytimefct)) +\n  geom_point(size = 3) +\n  geom_jitter(width = 0.1, alpha = 0.6, size = 3) +\n  xlab (\"Math first period grade\") +\n  ylab (\"Math final grade\")+ \n  geom_smooth(method = lm)\ng1\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nFrom this plot we could see the correlation between the 1st and the final math score is not changed solely by the time students spent on studying. Then how about different career choices by their fathers?\n\ng2 &lt;- matpor4rename1 |&gt; ggplot (aes (x = G1_mat, y = G3_mat)) +\n  geom_point(size = 3) +\n  geom_jitter(width = 0.1, alpha = 0.6, size = 3) +\n  xlab (\"Math first period grade\") +\n  ylab (\"Math final grade\")+ \n  geom_smooth(method = lm)\ng2 + facet_wrap (~Fjobfct)\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nSo the correlation between 1st and final math score is pretty strong, but having a father working in the health industry seemed to be more likely to improve your math results. Now we would like to see the effect of each combination of the two categorical variables on the relationship of 1st vs final Math test.\n\ng2 + facet_grid(studytimefct ~ Fjobfct) +\n  ylim (c(4,24))\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\nWarning in qt((1 - level)/2, df): NaNs produced\n\n\nWarning in max(ids, na.rm = TRUE): no non-missing arguments to max; returning\n-Inf\nWarning in max(ids, na.rm = TRUE): no non-missing arguments to max; returning\n-Inf\n\n\n\n\n\n\n\n\n\nThis visualization offers a broader view of both factors on score improvement. First, it looks like the length of study per week affect the 1st test score of math, espeically when the dad works for the public sector. Probably that reflects the students’ study habits. Second it looks like studying for 5-10 hours per week might results in better improvement of score, especially if you have a health worker dad or a teacher dad. All in all, it is an excellent data set to explore the students’ performance with their family conditions."
  }
]